{"version":3,"sources":["assets\\Script\\LoadingScene.js"],"names":["GameData","require","GameTools","GameUiTools","GameConfig","AnimLayerTool","cc","Class","Component","properties","start","setTimeout","loadingResource","loadingSceneType","LoadingSceneType","LoadingSceneFirst","IS_GAME_MUSIC","getItemByLocalStorage","initFrameCache","initWxSetting","LoadingSceneEnterGame","IS_GAME_OVER","initData","heightScore","getHeightScore","isHaveGameData","loadGameData","setHaveGameData","setHeightScore","LoadingSceneBackGame","director","preloadScene","loadScene","loader","loadRes","LabelAtlas","err","atlas","numberLabelAtlas","CC_WECHATGAME","window","wx","onHide","stopBackgroundMusic","onShow","playBackgroundMusic","onAudioInterruptionBegin","onAudioInterruptionEnd","showShareMenu","withShareTicket","onShareAppMessage","title","imageUrl","canvas","toTempFilePathSync","destWidth","destHeight","LaunchOption","getLaunchOptionsSync","query","x","undefined","MAIN_MENU_NUM","Number","info","getSystemInfoSync","GameClubButton","createGameClubButton","icon","style","left","windowWidth","top","windowHeight","width","height","hide"],"mappings":"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","sourceRoot":"/","sourcesContent":["var GameData = require(\"GameData\");\nvar GameTools = require(\"GameTools\");\nvar GameUiTools = require(\"GameUiTools\");\nvar GameConfig = require(\"GameConfig\");\nvar AnimLayerTool = require(\"AnimLayerTool\");\ncc.Class({\n    extends: cc.Component,\n    properties: {},\n\n    start() {\n        setTimeout(() => {\n            this.loadingResource();\n        }, 10);\n    },\n\n    loadingResource() {\n        if (GameConfig.loadingSceneType == GameConfig.LoadingSceneType.LoadingSceneFirst) {\n            // GameTools.setGameIntegral(GameTools.getGameIntegral()+1000);\n            GameConfig.IS_GAME_MUSIC = GameTools.getItemByLocalStorage(\"IS_GAME_MUSIC\", true);\n            this.initFrameCache();\n            this.initWxSetting();\n        } else if (GameConfig.loadingSceneType == GameConfig.LoadingSceneType.LoadingSceneEnterGame) {\n            GameConfig.IS_GAME_OVER = false;\n            GameData.initData();\n            GameData.heightScore = GameData.getHeightScore();\n            if (GameData.isHaveGameData()) {\n                if (GameData.loadGameData(true) || GameData.heightScore < 0 || GameData.heightScore > 1073741824) {\n                    GameData.setHaveGameData(false);\n                    GameData.heightScore = 0;\n                    GameData.setHeightScore(0);\n                }\n            }\n        } else if (GameConfig.loadingSceneType == GameConfig.LoadingSceneType.LoadingSceneBackGame) {\n            if(!GameConfig.IS_GAME_OVER){\n                GameData.loadGameData(false);\n            }\n            // GameData.destroyInstance();\n        }\n\n        if (GameConfig.loadingSceneType == GameConfig.LoadingSceneType.LoadingSceneFirst) {\n            cc.director.preloadScene(\"MenuUI\", function () {\n                cc.director.loadScene(\"MenuUI\");\n            });\n        }\n        else if (GameConfig.loadingSceneType == GameConfig.LoadingSceneType.LoadingSceneEnterGame) {\n            cc.director.preloadScene(\"GameScene\", function () {\n                cc.director.loadScene(\"GameScene\");\n            });\n        }\n        else if (GameConfig.loadingSceneType == GameConfig.LoadingSceneType.LoadingSceneBackGame) {\n            cc.director.preloadScene(\"MenuUI\", function () {\n                cc.director.loadScene(\"MenuUI\");\n            });\n        }\n    },\n    initFrameCache: function () {\n        cc.loader.loadRes(\"number\", cc.LabelAtlas, function (err, atlas) {\n            GameTools.numberLabelAtlas = atlas;\n        });\n    },\n    initWxSetting: function () {\n        if (CC_WECHATGAME) {\n            window.wx.onHide(function () {//监听小游戏隐藏到后台事件\n                if (GameConfig.loadingSceneType == GameConfig.LoadingSceneType.LoadingSceneEnterGame && !GameConfig.IS_GAME_OVER) {\n                    GameData.loadGameData(false);\n                    GameTools.stopBackgroundMusic();\n                }\n            });\n            window.wx.onShow(() => {\n                if (GameConfig.loadingSceneType == GameConfig.LoadingSceneType.LoadingSceneEnterGame && !GameConfig.IS_GAME_OVER) {\n                    if (GameConfig.IS_GAME_MUSIC) {\n                        GameTools.playBackgroundMusic();\n                    }\n                }\n            });\n            window.wx.onAudioInterruptionBegin(() => {\n                GameTools.stopBackgroundMusic();\n            });\n            window.wx.onAudioInterruptionEnd(() => {//监听音频中断结束\n                if (GameConfig.loadingSceneType == GameConfig.LoadingSceneType.LoadingSceneEnterGame && !GameConfig.IS_GAME_OVER) {\n                    if (GameConfig.IS_GAME_MUSIC) {\n                        GameTools.playBackgroundMusic();\n                    }\n                }\n            });\n            window.wx.showShareMenu({withShareTicket: true});\n            window.wx.onShareAppMessage(function () {\n                // 用户点击了“转发”按钮\n                return {\n                    title: '来跟我一起挑战浪漫2048。',\n                    imageUrl: canvas.toTempFilePathSync({\n                        destWidth: 500,\n                        destHeight: 400\n                    })\n                }\n            });\n            let LaunchOption = wx.getLaunchOptionsSync();\n            if (LaunchOption.query != {} && LaunchOption.query.x != undefined) {\n                GameConfig.MAIN_MENU_NUM = Number(LaunchOption.query.x);\n            }\n            let info = window.wx.getSystemInfoSync();\n            GameConfig.GameClubButton = window.wx.createGameClubButton({\n                icon: 'green',\n                style: {\n                    left: info.windowWidth / 2 + 25,\n                    top: info.windowHeight * 90 / 100,\n                    width: 40,\n                    height: 40\n                }\n            });\n            GameConfig.GameClubButton.hide()\n        } else {\n            // GameTools.getRankData(\"测试群排行\");\n        }\n    },\n});\n"]}