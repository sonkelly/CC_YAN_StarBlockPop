
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/GameScene.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'b71benT1ABC0aPZ2HVTgCte', 'GameScene');
// Script/GameScene.js

"use strict";

var GamePopStar = require("GamePopStar");

var GameData = require("GameData");

var GameTools = require("GameTools");

var GameUiTools = require("GameUiTools");

var GameConfig = require("GameConfig");

var AnimLayerTool = require("AnimLayerTool");

var GameScene = cc.Class({
  "extends": cc.Component,
  properties: {
    layerBack: cc.Sprite,
    backButton: cc.Node,
    //返回按钮
    cardNumberTTF: cc.Label,
    // 显示分数控件
    bestScoreTTF: cc.Label,
    // 显示最高分数控件
    progressBar: cc.Node,
    //进度条
    passNumTTF: cc.Label,
    //关数
    propMenu: [cc.Node],
    //道具按钮
    currentScore: 0,
    //当前得分
    isAddScore: false,
    //是否加分
    gameLogicLayer: cc.Node
  },
  ctor: function ctor() {
    GameConfig.GameScene = this;
    GameTools.playBackgroundMusic();
  },
  onLoad: function onLoad() {
    GameConfig.GameLogic = new GamePopStar();
    this.gameLogicLayer.addChild(GameConfig.GameLogic);
    this.currentScore = GameData.score0;
    this.cardNumberTTF.string = GameData.score0;
    this.bestScoreTTF.string = GameData.getGamePassScore();
    this.passNumTTF.string = "第 " + GameData.getGamePassNum() + " 关";
    GameUiTools.setButtonClickEvents(this, this.backButton, "backButtonFunc");
    GameUiTools.setButtonClickEvents(this, this.propMenu, "functionMenuTouchFunc");
  },
  start: function start() {},
  backButtonFunc: function backButtonFunc(event) {
    GameTools.playSimpleAudioEngine(0);
    this.loadingResource();
  },
  functionMenuTouchFunc: function functionMenuTouchFunc(event) {
    GameTools.playSimpleAudioEngine(0);
    var button = event.target;

    if (this.propMenu[0] == button) {
      if (GameData.getGamePropNumber(0) >= 1) {
        GameConfig.propsMenu = GameConfig.PropsMenu.PropsMenuDestroyCard;
      } else {
        this.showGamePropHelp(0);
        GameConfig.propsMenu = GameConfig.PropsMenu.PropsMenuSpace;
      }
    } else if (this.propMenu[1] == button) {
      if (GameData.getGamePropNumber(1) >= 1) {
        GameConfig.propsMenu = GameConfig.PropsMenu.PropsMenuRemoveAcross;
      } else {
        this.showGamePropHelp(1);
        GameConfig.propsMenu = GameConfig.PropsMenu.PropsMenuSpace;
      }
    } else if (this.propMenu[2] == button) {
      if (GameData.getGamePropNumber(2) >= 1) {
        GameConfig.propsMenu = GameConfig.PropsMenu.PropsMenuExchangeCard;
      } else {
        this.showGamePropHelp(2);
        GameConfig.propsMenu = GameConfig.PropsMenu.PropsMenuSpace;
      }
    } else {
      GameConfig.propsMenu = GameConfig.PropsMenu.PropsMenuSpace;
    }
  },
  showGamePropHelp: function showGamePropHelp(propType) {
    cc.loader.loadRes("panel/GamePropHelp", function (err, prefab) {
      var node = cc.instantiate(prefab);
      node.getComponent("GamePropHelp").setPropType(propType);
      cc.director.getScene().children[0].addChild(node);
    });
  },
  setGamePropNumber: function setGamePropNumber(propType) {
    this.propMenu[propType].getComponent("GamePropNode").setPropType();
  },
  setScore: function setScore(score) {
    if (this.currentScore > score) {
      this.currentScore = score;
      this.cardNumberTTF.string = this.currentScore;
    } else {
      this.isAddScore = true;
    }

    if (score > GameData.heightScore) {
      GameData.heightScore = score;
    }

    this.progressBar.scaleX = score / GameData.getGamePassScore() * 0.8;

    if (this.progressBar.scaleX > 0.9) {
      this.progressBar.scaleX = 0.9;
    }
  },
  update: function update(dt) {
    if (this.isAddScore && this.currentScore <= GameData.score0) {
      this.cardNumberTTF.string = this.currentScore++;
      this.currentScore++;
    } else {
      this.isAddScore = false;
    }
  },
  setPassNum: function setPassNum() {
    this.passNumTTF.string = "第 " + GameData.getGamePassNum() + " 关";
    this.bestScoreTTF.string = GameData.getGamePassScore();
  },
  loadingResource: function loadingResource() {
    GameTools.stopBackgroundMusic();
    GameConfig.loadingSceneType = GameConfig.LoadingSceneType.LoadingSceneBackGame;
    cc.director.loadScene("LoadingScene");
  } //特价9.9元一套cocoscreator代码联系Q2483367084 
  //截图 链接：https://share.weiyun.com/leGAHpnB 密码：b9udtv

});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0XFxHYW1lU2NlbmUuanMiXSwibmFtZXMiOlsiR2FtZVBvcFN0YXIiLCJyZXF1aXJlIiwiR2FtZURhdGEiLCJHYW1lVG9vbHMiLCJHYW1lVWlUb29scyIsIkdhbWVDb25maWciLCJBbmltTGF5ZXJUb29sIiwiR2FtZVNjZW5lIiwiY2MiLCJDbGFzcyIsIkNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJsYXllckJhY2siLCJTcHJpdGUiLCJiYWNrQnV0dG9uIiwiTm9kZSIsImNhcmROdW1iZXJUVEYiLCJMYWJlbCIsImJlc3RTY29yZVRURiIsInByb2dyZXNzQmFyIiwicGFzc051bVRURiIsInByb3BNZW51IiwiY3VycmVudFNjb3JlIiwiaXNBZGRTY29yZSIsImdhbWVMb2dpY0xheWVyIiwiY3RvciIsInBsYXlCYWNrZ3JvdW5kTXVzaWMiLCJvbkxvYWQiLCJHYW1lTG9naWMiLCJhZGRDaGlsZCIsInNjb3JlMCIsInN0cmluZyIsImdldEdhbWVQYXNzU2NvcmUiLCJnZXRHYW1lUGFzc051bSIsInNldEJ1dHRvbkNsaWNrRXZlbnRzIiwic3RhcnQiLCJiYWNrQnV0dG9uRnVuYyIsImV2ZW50IiwicGxheVNpbXBsZUF1ZGlvRW5naW5lIiwibG9hZGluZ1Jlc291cmNlIiwiZnVuY3Rpb25NZW51VG91Y2hGdW5jIiwiYnV0dG9uIiwidGFyZ2V0IiwiZ2V0R2FtZVByb3BOdW1iZXIiLCJwcm9wc01lbnUiLCJQcm9wc01lbnUiLCJQcm9wc01lbnVEZXN0cm95Q2FyZCIsInNob3dHYW1lUHJvcEhlbHAiLCJQcm9wc01lbnVTcGFjZSIsIlByb3BzTWVudVJlbW92ZUFjcm9zcyIsIlByb3BzTWVudUV4Y2hhbmdlQ2FyZCIsInByb3BUeXBlIiwibG9hZGVyIiwibG9hZFJlcyIsImVyciIsInByZWZhYiIsIm5vZGUiLCJpbnN0YW50aWF0ZSIsImdldENvbXBvbmVudCIsInNldFByb3BUeXBlIiwiZGlyZWN0b3IiLCJnZXRTY2VuZSIsImNoaWxkcmVuIiwic2V0R2FtZVByb3BOdW1iZXIiLCJzZXRTY29yZSIsInNjb3JlIiwiaGVpZ2h0U2NvcmUiLCJzY2FsZVgiLCJ1cGRhdGUiLCJkdCIsInNldFBhc3NOdW0iLCJzdG9wQmFja2dyb3VuZE11c2ljIiwibG9hZGluZ1NjZW5lVHlwZSIsIkxvYWRpbmdTY2VuZVR5cGUiLCJMb2FkaW5nU2NlbmVCYWNrR2FtZSIsImxvYWRTY2VuZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxXQUFXLEdBQUdDLE9BQU8sQ0FBQyxhQUFELENBQXpCOztBQUNBLElBQUlDLFFBQVEsR0FBR0QsT0FBTyxDQUFDLFVBQUQsQ0FBdEI7O0FBQ0EsSUFBSUUsU0FBUyxHQUFHRixPQUFPLENBQUMsV0FBRCxDQUF2Qjs7QUFDQSxJQUFJRyxXQUFXLEdBQUdILE9BQU8sQ0FBQyxhQUFELENBQXpCOztBQUNBLElBQUlJLFVBQVUsR0FBR0osT0FBTyxDQUFDLFlBQUQsQ0FBeEI7O0FBQ0EsSUFBSUssYUFBYSxHQUFHTCxPQUFPLENBQUMsZUFBRCxDQUEzQjs7QUFDQSxJQUFJTSxTQUFTLEdBQUdDLEVBQUUsQ0FBQ0MsS0FBSCxDQUFTO0FBQ3JCLGFBQVNELEVBQUUsQ0FBQ0UsU0FEUztBQUVyQkMsRUFBQUEsVUFBVSxFQUFFO0FBQ1JDLElBQUFBLFNBQVMsRUFBRUosRUFBRSxDQUFDSyxNQUROO0FBRVJDLElBQUFBLFVBQVUsRUFBRU4sRUFBRSxDQUFDTyxJQUZQO0FBRWE7QUFDckJDLElBQUFBLGFBQWEsRUFBRVIsRUFBRSxDQUFDUyxLQUhWO0FBR2dCO0FBQ3hCQyxJQUFBQSxZQUFZLEVBQUVWLEVBQUUsQ0FBQ1MsS0FKVDtBQUllO0FBQ3ZCRSxJQUFBQSxXQUFXLEVBQUVYLEVBQUUsQ0FBQ08sSUFMUjtBQUthO0FBQ3JCSyxJQUFBQSxVQUFVLEVBQUVaLEVBQUUsQ0FBQ1MsS0FOUDtBQU1hO0FBQ3JCSSxJQUFBQSxRQUFRLEVBQUUsQ0FBQ2IsRUFBRSxDQUFDTyxJQUFKLENBUEY7QUFPWTtBQUVwQk8s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QUE0QkMsb0JBQTFEO0FBQ0FsRSxJQUFBQSxFQUFFLENBQUNvRCxRQUFILENBQVllLFNBQVosQ0FBc0IsY0FBdEI7QUFDSCxHQTNHb0IsQ0EyR25CO0FBQ047O0FBNUd5QixDQUFULENBQWhCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgR2FtZVBvcFN0YXIgPSByZXF1aXJlKFwiR2FtZVBvcFN0YXJcIik7XG52YXIgR2FtZURhdGEgPSByZXF1aXJlKFwiR2FtZURhdGFcIik7XG52YXIgR2FtZVRvb2xzID0gcmVxdWlyZShcIkdhbWVUb29sc1wiKTtcbnZhciBHYW1lVWlUb29scyA9IHJlcXVpcmUoXCJHYW1lVWlUb29sc1wiKTtcbnZhciBHYW1lQ29uZmlnID0gcmVxdWlyZShcIkdhbWVDb25maWdcIik7XG52YXIgQW5pbUxheWVyVG9vbCA9IHJlcXVpcmUoXCJBbmltTGF5ZXJUb29sXCIpO1xudmFyIEdhbWVTY2VuZSA9IGNjLkNsYXNzKHtcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBsYXllckJhY2s6IGNjLlNwcml0ZSxcbiAgICAgICAgYmFja0J1dHRvbjogY2MuTm9kZSwgLy/ov5Tlm57mjInpkq5cbiAgICAgICAgY2FyZE51bWJlclRURjogY2MuTGFiZWwsLy8g5pi+56S65YiG5pWw5o6n5Lu2XG4gICAgICAgIGJlc3RTY29yZVRURjogY2MuTGFiZWwsLy8g5pi+56S65pyA6auY5YiG5pWw5o6n5Lu2XG4gICAgICAgIHByb2dyZXNzQmFyOiBjYy5Ob2RlLC8v6L+b5bqm5p2hXG4gICAgICAgIHBhc3NOdW1UVEY6IGNjLkxhYmVsLC8v5YWz5pWwXG4gICAgICAgIHByb3BNZW51OiBbY2MuTm9kZV0sLy/pgZPlhbfmjInpkq5cblxuICAgICAgICBjdXJyZW50U2NvcmU6IDAsLy/lvZPliY3lvpfliIZcbiAgICAgICAgaXNBZGRTY29yZTogZmFsc2UsLy/mmK/lkKbliqDliIZcblxuICAgICAgICBnYW1lTG9naWNMYXllcjogY2MuTm9kZSxcbiAgICB9LFxuICAgIGN0b3I6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgR2FtZUNvbmZpZy5HYW1lU2NlbmUgPSB0aGlzO1xuICAgICAgICBHYW1lVG9vbHMucGxheUJhY2tncm91bmRNdXNpYygpO1xuICAgIH0sXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIEdhbWVDb25maWcuR2FtZUxvZ2ljID0gbmV3IEdhbWVQb3BTdGFyKCk7XG4gICAgICAgIHRoaXMuZ2FtZUxvZ2ljTGF5ZXIuYWRkQ2hpbGQoR2FtZUNvbmZpZy5HYW1lTG9naWMpO1xuXG4gICAgICAgIHRoaXMuY3VycmVudFNjb3JlID0gR2FtZURhdGEuc2NvcmUwO1xuICAgICAgICB0aGlzLmNhcmROdW1iZXJUVEYuc3RyaW5nID0gR2FtZURhdGEuc2NvcmUwO1xuICAgICAgICB0aGlzLmJlc3RTY29yZVRURi5zdHJpbmcgPSBHYW1lRGF0YS5nZXRHYW1lUGFzc1Njb3JlKCk7XG4gICAgICAgIHRoaXMucGFzc051bVRURi5zdHJpbmcgPSBcIuesrCBcIiArIEdhbWVEYXRhLmdldEdhbWVQYXNzTnVtKCkgKyBcIiDlhbNcIjtcbiAgICAgICAgR2FtZVVpVG9vbHMuc2V0QnV0dG9uQ2xpY2tFdmVudHModGhpcywgdGhpcy5iYWNrQnV0dG9uLCBcImJhY2tCdXR0b25GdW5jXCIpO1xuICAgICAgICBHYW1lVWlUb29scy5zZXRCdXR0b25DbGlja0V2ZW50cyh0aGlzLCB0aGlzLnByb3BNZW51LCBcImZ1bmN0aW9uTWVudVRvdWNoRnVuY1wiKTtcbiAgICB9LFxuICAgIHN0YXJ0KCkge1xuICAgIH0sXG4gICAgYmFja0J1dHRvbkZ1bmM6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBHYW1lVG9vbHMucGxheVNpbXBsZUF1ZGlvRW5naW5lKDApO1xuICAgICAgICB0aGlzLmxvYWRpbmdSZXNvdXJjZSgpO1xuICAgIH0sXG4gICAgZnVuY3Rpb25NZW51VG91Y2hGdW5jOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgR2FtZVRvb2xzLnBsYXlTaW1wbGVBdWRpb0VuZ2luZSgwKTtcbiAgICAgICAgbGV0IGJ1dHRvbiA9IGV2ZW50LnRhcmdldDtcbiAgICAgICAgaWYgKHRoaXMucHJvcE1lbnVbMF0gPT0gYnV0dG9uKSB7XG4gICAgICAgICAgICBpZiAoR2FtZURhdGEuZ2V0R2FtZVByb3BOdW1iZXIoMCkgPj0gMSkge1xuICAgICAgICAgICAgICAgIEdhbWVDb25maWcucHJvcHNNZW51ID0gR2FtZUNvbmZpZy5Qcm9wc01lbnUuUHJvcHNNZW51RGVzdHJveUNhcmQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0dhbWVQcm9wSGVscCgwKTtcbiAgICAgICAgICAgICAgICBHYW1lQ29uZmlnLnByb3BzTWVudSA9IEdhbWVDb25maWcuUHJvcHNNZW51LlByb3BzTWVudVNwYWNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMucHJvcE1lbnVbMV0gPT0gYnV0dG9uKSB7XG4gICAgICAgICAgICBpZiAoR2FtZURhdGEuZ2V0R2FtZVByb3BOdW1iZXIoMSkgPj0gMSkge1xuICAgICAgICAgICAgICAgIEdhbWVDb25maWcucHJvcHNNZW51ID0gR2FtZUNvbmZpZy5Qcm9wc01lbnUuUHJvcHNNZW51UmVtb3ZlQWNyb3NzO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dHYW1lUHJvcEhlbHAoMSk7XG4gICAgICAgICAgICAgICAgR2FtZUNvbmZpZy5wcm9wc01lbnUgPSBHYW1lQ29uZmlnLlByb3BzTWVudS5Qcm9wc01lbnVTcGFjZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnByb3BNZW51WzJdID09IGJ1dHRvbikge1xuICAgICAgICAgICAgaWYgKEdhbWVEYXRhLmdldEdhbWVQcm9wTnVtYmVyKDIpID49IDEpIHtcbiAgICAgICAgICAgICAgICBHYW1lQ29uZmlnLnByb3BzTWVudSA9IEdhbWVDb25maWcuUHJvcHNNZW51LlByb3BzTWVudUV4Y2hhbmdlQ2FyZDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93R2FtZVByb3BIZWxwKDIpO1xuICAgICAgICAgICAgICAgIEdhbWVDb25maWcucHJvcHNNZW51ID0gR2FtZUNvbmZpZy5Qcm9wc01lbnUuUHJvcHNNZW51U3BhY2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBHYW1lQ29uZmlnLnByb3BzTWVudSA9IEdhbWVDb25maWcuUHJvcHNNZW51LlByb3BzTWVudVNwYWNlO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBzaG93R2FtZVByb3BIZWxwKHByb3BUeXBlKSB7XG4gICAgICAgIGNjLmxvYWRlci5sb2FkUmVzKFwicGFuZWwvR2FtZVByb3BIZWxwXCIsIChlcnIsIHByZWZhYikgPT4ge1xuICAgICAgICAgICAgbGV0IG5vZGUgPSBjYy5pbnN0YW50aWF0ZShwcmVmYWIpO1xuICAgICAgICAgICAgbm9kZS5nZXRDb21wb25lbnQoXCJHYW1lUHJvcEhlbHBcIikuc2V0UHJvcFR5cGUocHJvcFR5cGUpO1xuICAgICAgICAgICAgY2MuZGlyZWN0b3IuZ2V0U2NlbmUoKS5jaGlsZHJlblswXS5hZGRDaGlsZChub2RlKTtcbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICBzZXRHYW1lUHJvcE51bWJlcihwcm9wVHlwZSkge1xuICAgICAgICB0aGlzLnByb3BNZW51W3Byb3BUeXBlXS5nZXRDb21wb25lbnQoXCJHYW1lUHJvcE5vZGVcIikuc2V0UHJvcFR5cGUoKTtcbiAgICB9LFxuICAgIHNldFNjb3JlOiBmdW5jdGlvbiAoc2NvcmUpIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFNjb3JlID4gc2NvcmUpIHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFNjb3JlID0gc2NvcmU7XG4gICAgICAgICAgICB0aGlzLmNhcmROdW1iZXJUVEYuc3RyaW5nID0gdGhpcy5jdXJyZW50U2NvcmU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmlzQWRkU2NvcmUgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzY29yZSA+IEdhbWVEYXRhLmhlaWdodFNjb3JlKSB7XG4gICAgICAgICAgICBHYW1lRGF0YS5oZWlnaHRTY29yZSA9IHNjb3JlO1xuXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wcm9ncmVzc0Jhci5zY2FsZVggPSBzY29yZSAvIChHYW1lRGF0YS5nZXRHYW1lUGFzc1Njb3JlKCkpICogMC44O1xuICAgICAgICBpZiAodGhpcy5wcm9ncmVzc0Jhci5zY2FsZVggPiAwLjkpIHtcbiAgICAgICAgICAgIHRoaXMucHJvZ3Jlc3NCYXIuc2NhbGVYID0gMC45O1xuICAgICAgICB9XG4gICAgfSxcbiAgICB1cGRhdGU6IGZ1bmN0aW9uIChkdCkge1xuICAgICAgICBpZiAodGhpcy5pc0FkZFNjb3JlICYmIHRoaXMuY3VycmVudFNjb3JlIDw9IEdhbWVEYXRhLnNjb3JlMCkge1xuICAgICAgICAgICAgdGhpcy5jYXJkTnVtYmVyVFRGLnN0cmluZyA9IHRoaXMuY3VycmVudFNjb3JlKys7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTY29yZSsrO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5pc0FkZFNjb3JlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHNldFBhc3NOdW0oKSB7XG4gICAgICAgIHRoaXMucGFzc051bVRURi5zdHJpbmcgPSBcIuesrCBcIiArIEdhbWVEYXRhLmdldEdhbWVQYXNzTnVtKCkgKyBcIiDlhbNcIjtcbiAgICAgICAgdGhpcy5iZXN0U2NvcmVUVEYuc3RyaW5nID0gR2FtZURhdGEuZ2V0R2FtZVBhc3NTY29yZSgpO1xuICAgIH0sXG4gICAgbG9hZGluZ1Jlc291cmNlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIEdhbWVUb29scy5zdG9wQmFja2dyb3VuZE11c2ljKCk7XG4gICAgICAgIEdhbWVDb25maWcubG9hZGluZ1NjZW5lVHlwZSA9IEdhbWVDb25maWcuTG9hZGluZ1NjZW5lVHlwZS5Mb2FkaW5nU2NlbmVCYWNrR2FtZTtcbiAgICAgICAgY2MuZGlyZWN0b3IubG9hZFNjZW5lKFwiTG9hZGluZ1NjZW5lXCIpO1xuICAgIH0sLy/nibnku7c5LjnlhYPkuIDlpZdjb2Nvc2NyZWF0b3Lku6PnoIHogZTns7tRMjQ4MzM2NzA4NCBcbi8v5oiq5Zu+IOmTvuaOpe+8mmh0dHBzOi8vc2hhcmUud2VpeXVuLmNvbS9sZUdBSHBuQiDlr4bnoIHvvJpiOXVkdHZcbn0pOyJdfQ==