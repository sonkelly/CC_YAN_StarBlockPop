
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/GameTools.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '415acQw6oNBeo2WRVLPUaoS', 'GameTools');
// Script/GameTools.js

"use strict";

var GameConfig = require("GameConfig");

var GameTools = {
  love2048FrameCache: null,
  numberLabelAtlas: null,
  backMusicIsPlay: null,
  playSimpleAudioEngine: function playSimpleAudioEngine(engineType) {
    if (GameConfig.IS_GAME_MUSIC) {
      switch (engineType) {
        case 0:
          cc.audioEngine.play(cc.url.raw('resources/sounds/pop_star.mp3'), false, 0.5);
          break;

        case 1:
          cc.audioEngine.play(cc.url.raw('resources/sounds/select.mp3'), false, 0.5);
          break;

        case 2:
          cc.audioEngine.play(cc.url.raw("resources/sounds/landing.mp3"), false, 0.5);
          break;

        case 3:
          cc.audioEngine.play(cc.url.raw("resources/sounds/cheers.mp3"), false, 0.5);
          break;

        default:
          break;
      }
    }
  },
  playBackgroundMusic: function playBackgroundMusic() {
    if (GameConfig.IS_GAME_MUSIC) {
      if (GameTools.backMusicIsPlay == null) {
        GameTools.backMusicIsPlay = cc.audioEngine.play(cc.url.raw('resources/sounds/backMusic.mp3'), true, 0.5);
      }
    }
  },
  stopBackgroundMusic: function stopBackgroundMusic() {
    if (GameTools.backMusicIsPlay != null) {
      cc.audioEngine.stop(GameTools.backMusicIsPlay);
      GameTools.backMusicIsPlay = null;
    }
  },
  getItemByLocalStorage: function getItemByLocalStorage(key, value) {
    var values = cc.sys.localStorage.getItem(key);

    if (values === undefined || values === null || values === '') {
      cc.sys.localStorage.setItem(key, value);
      return value;
    }

    if (typeof value === 'boolean') {
      if (typeof values === 'boolean') {
        return values;
      }

      return "true" == values;
    } else if (typeof value === 'number') {
      return Number(values);
    }

    return values;
  },
  setItemByLocalStorage: function setItemByLocalStorage(key, value) {
    cc.sys.localStorage.setItem(key, value);
  },
  toastMessage: function toastMessage(toastType) {
    cc.loader.loadRes("panel/ShowMessage", function (err, prefab) {
      if (!err) {
        var node = cc.instantiate(prefab);
        node.getComponent(cc.Component).toastType = toastType;
        cc.director.getScene().children[0].addChild(node); // cc.director.getScene().getChildByName('Canvas').addChild(node);
      }
    });
  },
  sharePicture: function sharePicture(pictureName) {
    var titleStr = '来跟我一起挑战浪漫2048吧。';

    if ("shareTicket" == pictureName) {
      titleStr = "看看你在群里排第几？来和我挑战浪漫2048吧。";
    } else if ("LotteryLayer" == pictureName) {
      //抽奖页面分享
      titleStr = "浪漫2048福利大放送！快进来抽奖吧！";
    } else if (pictureName != undefined && pictureName != null) {
      titleStr = "我得了" + pictureName + "分," + titleStr;
    }

    if (CC_WECHATGAME) {
      window.wx.shareAppMessage({
        title: titleStr,
        query: "x=" + GameConfig.MAIN_MENU_NUM,
        imageUrl: canvas.toTempFilePathSync({
          destWidth: 500,
          destHeight: 400
        }),
        success: function success(res) {
          if (res.shareTickets != undefined && res.shareTickets.length > 0) {
            if ("shareTicket" == pictureName) {
              window.wx.postMessage({
                messageType: 5,
                MAIN_MENU_NUM: GameConfig.MAIN_MENU_NUM == -1000 ? 1 : GameConfig.MAIN_MENU_NUM,
                shareTicket: res.shareTickets[0]
              });
            }
          }
        }
      });
    } else {
      cc.log("执行了截图" + titleStr);
    }
  },
  getGameIntegral: function getGameIntegral() {
    //获取积分
    return this.getItemByLocalStorage("GameIntegral", 0);
  },
  setGameIntegral: function setGameIntegral(intrgral) {
    // 设置积分
    cc.sys.localStorage.setItem("GameIntegral", intrgral);
  },
  commentGame: function commentGame() {
    //评论
    if (CC_WECHATGAME) {
      window.wx.openCustomerServiceConversation({});
    } else {
      this.toastMessage(1);
      cc.log("执行了评论");
    }
  },
  checkFirstLoginGame: function checkFirstLoginGame() {
    var _this = this;

    //检查是否首次登录
    var loginDate = Math.floor((new Date().getTime() - new Date(2018, 3, 18, 0, 0, 0, 0).getTime()) / (1000 * 60 * 60 * 24));

    if (loginDate > this.getItemByLocalStorage("FirstEnterGameDate", 0)) {
      cc.sys.localStorage.setItem("FirstEnterGameDate", loginDate);
      setTimeout(function () {
        _this.setGameIntegral(_this.getGameIntegral() + 100);

        _this.toastMessage(9);
      }, 1500);
    }
  },
  setCardBackPath: function setCardBackPath(num) //设置卡片背景路径
  {//GameConfig.setCardBackPath(num, "card/nl2048.png");
  },
  userLogin: function userLogin() {//用户登录
  },
  getRankData: function getRankData(shareTicket) {
    //获取排行榜
    cc.loader.loadRes("panel/RankingListView", function (err, prefab) {
      if (!err) {
        var node = cc.instantiate(prefab);

        if (shareTicket != undefined) {
          node.getComponent(cc.Component).shareTicket = shareTicket;
        } // node.setPosition(cc.p(0, 0));


        cc.director.getScene().children[0].addChild(node);
      }
    });
  },
  removeRankData: function removeRankData() {
    //移除排行榜数据
    if (CC_WECHATGAME) {
      window.wx.postMessage({
        messageType: 0
      });
    } else {
      cc.log("移除排行榜数据。");
    }
  },
  submitScore: function submitScore(score) {
    //提交得分
    if (CC_WECHATGAME) {
      window.wx.postMessage({
        messageType: 3,
        MAIN_MENU_NUM: GameConfig.MAIN_MENU_NUM,
        score: score
      });
    } else {
      cc.log("提交得分:" + GameConfig.MAIN_MENU_NUM + " : " + score);
    }
  },
  getSelectAddNum: function getSelectAddNum(num) //获取叠加数
  {
    if (num < 4) {
      num = 2;
    } else if (num < 8) {
      num = 4;
    } else if (num < 16) {
      num = 8;
    } else if (num < 32) {
      num = 16;
    } else if (num < 64) {
      num = 32;
    } else if (num < 128) {
      num = 64;
    } else if (num < 256) {
      num = 128;
    } else if (num < 512) {
      num = 256;
    } else if (num < 1024) {
      num = 512;
    } else if (num < 2048) {
      num = 1024;
    } else if (num < 4096) {
      num = 2048;
    } else if (num < 8192) {
      num = 4096;
    } else if (num < 16384) {
      num = 8192;
    } else if (num < 32768) {
      num = 16384;
    } else if (num < 65536) {
      num = 32768;
    } else if (num < 131072) {
      num = 65536;
    } else {
      num = 131072;
    }

    return num;
  }
};
module.exports = GameTools;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0XFxHYW1lVG9vbHMuanMiXSwibmFtZXMiOlsiR2FtZUNvbmZpZyIsInJlcXVpcmUiLCJHYW1lVG9vbHMiLCJsb3ZlMjA0OEZyYW1lQ2FjaGUiLCJudW1iZXJMYWJlbEF0bGFzIiwiYmFja011c2ljSXNQbGF5IiwicGxheVNpbXBsZUF1ZGlvRW5naW5lIiwiZW5naW5lVHlwZSIsIklTX0dBTUVfTVVTSUMiLCJjYyIsImF1ZGlvRW5naW5lIiwicGxheSIsInVybCIsInJhdyIsInBsYXlCYWNrZ3JvdW5kTXVzaWMiLCJzdG9wQmFja2dyb3VuZE11c2ljIiwic3RvcCIsImdldEl0ZW1CeUxvY2FsU3RvcmFnZSIsImtleSIsInZhbHVlIiwidmFsdWVzIiwic3lzIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsInVuZGVmaW5lZCIsInNldEl0ZW0iLCJOdW1iZXIiLCJzZXRJdGVtQnlMb2NhbFN0b3JhZ2UiLCJ0b2FzdE1lc3NhZ2UiLCJ0b2FzdFR5cGUiLCJsb2FkZXIiLCJsb2FkUmVzIiwiZXJyIiwicHJlZmFiIiwibm9kZSIsImluc3RhbnRpYXRlIiwiZ2V0Q29tcG9uZW50IiwiQ29tcG9uZW50IiwiZGlyZWN0b3IiLCJnZXRTY2VuZSIsImNoaWxkcmVuIiwiYWRkQ2hpbGQiLCJzaGFyZVBpY3R1cmUiLCJwaWN0dXJlTmFtZSIsInRpdGxlU3RyIiwiQ0NfV0VDSEFUR0FNRSIsIndpbmRvdyIsInd4Iiwic2hhcmVBcHBNZXNzYWdlIiwidGl0bGUiLCJxdWVyeSIsIk1BSU5fTUVOVV9OVU0iLCJpbWFnZVVybCIsImNhbnZhcyIsInRvVGVtcEZpbGVQYXRoU3luYyIsImRlc3RXaWR0aCIsImRlc3RIZWlnaHQiLCJzdWNjZXNzIiwicmVzIiwic2hhcmVUaWNrZXRzIiwibGVuZ3RoIiwicG9zdE1lc3NhZ2UiLCJtZXNzYWdlVHlwZSIsInNoYXJlVGlja2V0IiwibG9nIiwiZ2V0R2FtZUludGVncmFsIiwic2V0R2FtZUludGVncmFsIiwiaW50cmdyYWwiLCJjb21tZW50R2FtZSIsIm9wZW5DdXN0b21lclNlcnZpY2VDb252ZXJzYXRpb24iLCJjaGVja0ZpcnN0TG9naW5HYW1lIiwibG9naW5EYXRlIiwiTWF0aCIsImZsb29yIiwiRGF0ZSIsImdldFRpbWUiLCJzZXRUaW1lb3V0Iiwic2V0Q2FyZEJhY2tQYXRoIiwibnVtIiwidXNlckxvZ2luIiwiZ2V0UmFua0RhdGEiLCJyZW1vdmVSYW5rRGF0YSIsInN1Ym1pdFNjb3JlIiwic2NvcmUiLCJnZXRTZWxlY3RBZGROdW0iLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLFVBQVUsR0FBR0MsT0FBTyxDQUFDLFlBQUQsQ0FBeEI7O0FBQ0EsSUFBSUMsU0FBUyxHQUFHO0FBQ1pDLEVBQUFBLGtCQUFrQixFQUFFLElBRFI7QUFFWkMsRUFBQUEsZ0JBQWdCLEVBQUUsSUFGTjtBQUdaQyxFQUFBQSxlQUFlLEVBQUUsSUFITDtBQUlaQyxFQUFBQSxxQkFBcUIsRUFBRSwrQkFBVUMsVUFBVixFQUFzQjtBQUN6QyxRQUFJUCxVQUFVLENBQUNRLGFBQWYsRUFBOEI7QUFDMUIsY0FBUUQsVUFBUjtBQUNJLGFBQUssQ0FBTDtBQUNJRSxVQUFBQSxFQUFFLENBQUNDLFdBQUgsQ0FBZUMsSUFBZixDQUFvQkYsRUFBRSxDQUFDRyxHQUFILENBQU9DLEdBQVAsQ0FBVywrQkFBWCxDQUFwQixFQUFpRSxLQUFqRSxFQUF3RSxHQUF4RTtBQUNBOztBQUNKLGFBQUssQ0FBTDtBQUNJSixVQUFBQSxFQUFFLENBQUNDLFdBQUgsQ0FBZUMsSUFBZixDQUFvQkYsRUFBRSxDQUFDRyxHQUFILENBQU9DLEdBQVAsQ0FBVyw2QkFBWCxDQUFwQixFQUErRCxLQUEvRCxFQUFzRSxHQUF0RTtBQUNBOztBQUNKLGFBQUssQ0FBTDtBQUNJSixVQUFBQSxFQUFFLENBQUNDLFdBQUgsQ0FBZUMsSUFBZixDQUFvQkYsRUFBRSxDQUFDRyxHQUFILENBQU9DLEdBQVAsQ0FBVyw4QkFBWCxDQUFwQixFQUFnRSxLQUFoRSxFQUF1RSxHQUF2RTtBQUNBOztBQUNKLGFBQUssQ0FBTDtBQUNJSixVQUFBQSxFQUFFLENBQUNDLFdBQUgsQ0FBZUMsSUFBZixDQUFvQkYsRUFBRSxDQUFDRyxHQUFILENBQU9DLEdBQVAsQ0FBVyw2QkFBWCxDQUFwQixFQUErRCxLQUEvRCxFQUFzRSxHQUF0RTtBQUNBOztBQUNKO0FBQ0k7QUFkUjtBQWdCSDtBQUNKLEdBdkJXO0FBd0JaQyxFQUFBQSxtQkFBbUIsRUFBRSwrQkFBWTtBQUM3QixRQUFJZCxVQUFVLENBQUNRLGFBQWYsRUFBOEI7QUFDMUIsVUFBSU4sU0FBUyxDQUFDRyxlQUFWLElBQTZCLElBQWpDLEVBQXVDO0FBQ25DSCxRQUFBQSxTQUFTLENBQUNHLGVBQVYsR0FBNEJJLEVBQUUsQ0FBQ0MsV0FBSCxDQUFlQyxJQUFmLENBQW9CRixFQUFFLENBQUNHLEdBQUgsQ0FBT0MsR0FBUCxDQUFXLGdDQUFYLENBQXBCLEVBQWtFLElBQWxFLEVBQXdFLEdBQXhFLENBQTVCO0FBQ0g7QUFDSjtBQUNKLEdBOUJXO0FBK0JaRSxFQUFBQSxtQkFBbUIsRUFBRSwrQkFBWTtBQUM3QixRQUFJYixTQUFTLENBQUNHLGVBQVYsSUFBNkIsSUFBakMsRUFBdUM7QUFDbkNJLE1BQUFBLEVBQUUsQ0FBQ0MsV0FBSCxDQUFlTSxJQUFmLENBQW9CZCxTQUFTLENBQUNHLGVBQTlCO0FBQ0FILE1BQUFBLFNBQVMsQ0FBQ0csZUFBVixHQUE0QixJQUE1QjtBQUNIO0FBQ0osR0FwQ1c7QUFxQ1pZLEVBQUFBLHFCQUFxQixFQUFFLCtCQUFVQyxHQUFWLEVBQWVDLEtBQWYsRUFBc0I7QUFDekMsUUFBSUMsTUFBTSxHQUFHWCxFQUFFLENBQUNZLEdBQUgsQ0FBT0MsWUFBUCxDQUFvQkMsT0FBcEIsQ0FBNEJMLEdBQTVCLENBQWI7O0FBQ0EsUUFBSUUsTUFBTSxLQUFLSSxTQUFYLElBQXdCSixNQUFNLEtBQUssSUFBbkMsSUFBMkNBLE1BQU0sS0FBSyxFQUExRCxFQUE4RDtBQUMxRFgsTUFBQUEsRUFBRSxDQUFDWSxHQUFILENBQU9DLFlBQVAsQ0FBb0JHLE9BQXBCLENBQTRCUCxHQUE1QixFQUFpQ0MsS0FBakM7QUFDQSxhQUFPQSxLQUFQO0FBQ0g7O0FBQ0QsUUFBSSxPQUFPQSxLQUFQLEtBQWlCLFNBQXJCLEVBQWdDO0FBQzVCLFVBQUksT0FBT0MsTUFBUCxLQUFrQixTQUF0QixFQUFpQztBQUM3QixlQUFPQSxNQUFQO0FBQ0g7O0FBQ0QsYUFBTyxVQUFVQSxNQUFqQjtBQUNILEtBTEQsTUFLTyxJQUFJLE9BQU9ELEtBQVAsS0FBaUIsUUFBckIsRUFBK0I7QUFDbEMsYUFBT08sTUFBTSxDQUFDTixNQUFELENBQWI7QUFDSDs7QUFDRCxXQUFPQSxNQUFQO0FBQ0gsR0FwRFc7QUFxRFpPLEVBQUFBLHFCQUFxQixFQUFFLCtCQUFVVCxHQUFWLEVBQWVDLEtBQWYsRUFBc0I7QUFDekNWLElBQUFBLEVBQUUsQ0FBQ1ksR0FBSCxDQUFPQyxZQUFQLENBQW9CRyxPQUFwQixDQUE0QlAsR0FBNUIsRUFBaUNDLEtBQWpDO0FBQ0gsR0F2RFc7QUF3RFpTLEVBQUFBLFlBeERZLHdCQXdEQ0MsU0F4REQsRUF3RFk7QUFDcEJwQixJQUFBQSxFQUFFLENBQUNxQixNQUFILENBQVVDLE9BQVYsQ0FBa0IsbUJBQWxCLEVBQXVDLFVBQUNDLEdBQUQsRUFBTUMsTUFBTixFQUFpQjtBQUNwRCxVQUFJLENBQUNELEdBQUwsRUFBVTtBQUNOLFlBQUlFLElBQUksR0FBR3pCLEVBQUUsQ0FBQzBCLFdBQUgsQ0FBZUYsTUFBZixDQUFYO0FBQ0FDLFFBQUFBLElBQUksQ0FBQ0UsWUFBTCxDQUFrQjNCLEVBQUUsQ0FBQzRCLFNBQXJCLEVBQWdDUixTQUFoQyxHQUE0Q0EsU0FBNUM7QUFDQXBCLFFBQUFBLEVBQUUsQ0FBQzZCLFFBQUgsQ0FBWUMsUUFBWixHQUF1QkMsUUFBdkIsQ0FBZ0MsQ0FBaEMsRUFBbUNDLFFBQW5DLENBQTRDUCxJQUE1QyxFQUhNLENBSU47QUFDSDtBQUNKLEtBUEQ7QUFRSCxHQWpFVztBQWtFVlEsRUFBQUEsWUFsRVUsd0JBa0VHQyxXQWxFSCxFQWtFZ0I7QUFDeEIsUUFBSUMsUUFBUSxHQUFHLGlCQUFmOztBQUNBLFFBQUksaUJBQWlCRCxXQUFyQixFQUFrQztBQUM5QkMsTUFBQUEsUUFBUSxHQUFHLHlCQUFYO0FBQ0gsS0FGRCxNQUVPLElBQUksa0JBQWtCRCxXQUF0QixFQUFtQztBQUFDO0FBQ3ZDQyxNQUFBQSxRQUFRLEdBQUcscUJBQVg7QUFDSCxLQUZNLE1BRUEsSUFBSUQsV0FBVyxJQUFJbkIsU0FBZixJQUE0Qm1CLFdBQVcsSUFBSSxJQUEvQyxFQUFxRDtBQUN4REMsTUFBQUEsUUFBUSxHQUFHLFFBQVFELFdBQVIsR0FBc0IsSUFBdEIsR0FBNkJDLFFBQXhDO0FBQ0g7O0FBQ0QsUUFBSUMsYUFBSixFQUFtQjtBQUNmQyxNQUFBQSxNQUFNLENBQUNDLEVBQVAsQ0FBVUMsZUFBVixDQUEwQjtBQUN0QkMsUUFBQUEsS0FBSyxFQUFFTCxRQURlO0FBRXRCTSxRQUFBQSxLQUFLLEVBQUUsT0FBT2xELFVBQVUsQ0FBQ21ELGFBRkg7QUFHdEJDLFFBQUFBLFFBQVEsRUFBRUMsTUFBTSxDQUFDQyxrQkFBUCxDQUEwQjtBQUNoQ0MsVUFBQUEsU0FBUyxFQUFFLEdBRHFCO0FBRWhDQyxVQUFBQSxVQUFVLEVBQUU7QUFGb0IsU0FBMUIsQ0FIWTtBQU90QkMsUUFBQUEsT0FBTyxFQUFFLGlCQUFDQyxHQUFELEVBQVM7QUFDZCxjQUFJQSxHQUFHLENBQUNDLFlBQUosSUFBb0JuQyxTQUFwQixJQUFpQ2tDLEdBQUcsQ0FBQ0MsWUFBSixDQUFpQkMsTUFBakIsR0FBMEIsQ0FBL0QsRUFBa0U7QUFDOUQsZ0JBQUksaUJBQWlCakIsV0FBckIsRUFBa0M7QUFDOUJHLGNBQUFBLE1BQU0sQ0FBQ0MsRUFBUCxDQUFVYyxXQUFWLENBQXNCO0FBQ2xCQyxnQkFBQUEsV0FBVyxFQUFFLENBREs7QUFFbEJYLGdCQUFBQSxhQUFhLEVBQUVuRCxVQUFVLENBQUNtRCxhQUFYLElBQTRCLENBQUMsSUFBN0IsR0FBb0MsQ0FBcEMsR0FBd0NuRCxVQUFVLENBQUNtRCxhQUZoRDtBQUdsQlksZ0JBQUFBLFdBQVcsRUFBRUwsR0FBRyxDQUFDQyxZQUFKLENBQWlCLENBQWpCO0FBSEssZUFBdEI7QUFLSDtBQUNKO0FBQ0o7QUFqQnFCLE9BQTFCO0FBbUJILEtBcEJELE1Bb0JPO0FBQ0hsRCxNQUFBQSxFQUFFLENBQUN1RCxHQUFILENBQU8sVUFBVXBCLFFBQWpCO0FBQ0g7QUFDSixHQWxHVztBQW1HWnFCLEVBQUFBLGVBbkdZLDZCQW1HTTtBQUFFO0FBQ2hCLFdBQU8sS0FBS2hELHFCQUFMLENBQTJCLGNBQTNCLEVBQTJDLENBQTNDLENBQVA7QUFDSCxHQXJHVztBQXNHWmlELEVBQUFBLGVBdEdZLDJCQXNHSUMsUUF0R0osRUFzR2M7QUFBRTtBQUN4QjFELElBQUFBLEVBQUUsQ0FBQ1ksR0FBSCxDQUFPQyxZQUFQLENBQW9CRyxPQUFwQixDQUE0QixjQUE1QixFQUE0QzBDLFFBQTVDO0FBQ0gsR0F4R1c7QUF5R1ZDLEVBQUFBLFdBekdVLHlCQXlHSTtBQUFFO0FBQ2QsUUFBSXZCLGFBQUosRUFBbUI7QUFDZkMsTUFBQUEsTUFBTSxDQUFDQyxFQUFQLENBQVVzQiwrQkFBVixDQUEwQyxFQUExQztBQUNILEtBRkQsTUFFTztBQUNILFdBQUt6QyxZQUFMLENBQWtCLENBQWxCO0FBQ0FuQixNQUFBQSxFQUFFLENBQUN1RCxHQUFILENBQU8sT0FBUDtBQUNIO0FBQ0osR0FoSFc7QUFpSFZNLEVBQUFBLG1CQWpIVSxpQ0FpSFk7QUFBQTs7QUFBRTtBQUN0QixRQUFJQyxTQUFTLEdBQUdDLElBQUksQ0FBQ0MsS0FBTCxDQUFXLENBQUMsSUFBSUMsSUFBSixHQUFXQyxPQUFYLEtBQXVCLElBQUlELElBQUosQ0FBUyxJQUFULEVBQWUsQ0FBZixFQUFrQixFQUFsQixFQUFzQixDQUF0QixFQUF5QixDQUF6QixFQUE0QixDQUE1QixFQUErQixDQUEvQixFQUFrQ0MsT0FBbEMsRUFBeEIsS0FBd0UsT0FBTyxFQUFQLEdBQVksRUFBWixHQUFpQixFQUF6RixDQUFYLENBQWhCOztBQUNBLFFBQUlKLFNBQVMsR0FBRyxLQUFLdEQscUJBQUwsQ0FBMkIsb0JBQTNCLEVBQWlELENBQWpELENBQWhCLEVBQXFFO0FBQ2pFUixNQUFBQSxFQUFFLENBQUNZLEdBQUgsQ0FBT0MsWUFBUCxDQUFvQkcsT0FBcEIsQ0FBNEIsb0JBQTVCLEVBQWtEOEMsU0FBbEQ7QUFDQUssTUFBQUEsVUFBVSxDQUFDLFlBQU07QUFDYixRQUFBLEtBQUksQ0FBQ1YsZUFBTCxDQUFxQixLQUFJLENBQUNELGVBQUwsS0FBeUIsR0FBOUM7O0FBQ0EsUUFBQSxLQUFJLENBQUNyQyxZQUFMLENBQWtCLENBQWxCO0FBQ0gsT0FIUyxFQUdQLElBSE8sQ0FBVjtBQUlIO0FBQ0osR0ExSFc7QUE0SFZpRCxFQUFBQSxlQTVIVSwyQkE0SE1DLEdBNUhOLEVBNEhVO0FBQ3RCLEdBQ0k7QUFDSCxHQS9IVztBQWlJVkMsRUFBQUEsU0FqSVUsdUJBaUlFLENBQUU7QUFDZixHQWxJVztBQW9JVkMsRUFBQUEsV0FwSVUsdUJBb0lFakIsV0FwSUYsRUFvSWU7QUFBRTtBQUN6QnRELElBQUFBLEVBQUUsQ0FBQ3FCLE1BQUgsQ0FBVUMsT0FBVixDQUFrQix1QkFBbEIsRUFBMkMsVUFBQ0MsR0FBRCxFQUFNQyxNQUFOLEVBQWlCO0FBQ3hELFVBQUksQ0FBQ0QsR0FBTCxFQUFVO0FBQ04sWUFBSUUsSUFBSSxHQUFHekIsRUFBRSxDQUFDMEIsV0FBSCxDQUFlRixNQUFmLENBQVg7O0FBQ0EsWUFBSThCLFdBQVcsSUFBSXZDLFNBQW5CLEVBQThCO0FBQzFCVSxVQUFBQSxJQUFJLENBQUNFLFlBQUwsQ0FBa0IzQixFQUFFLENBQUM0QixTQUFyQixFQUFnQzBCLFdBQWhDLEdBQThDQSxXQUE5QztBQUNILFNBSkssQ0FLTjs7O0FBQ0F0RCxRQUFBQSxFQUFFLENBQUM2QixRQUFILENBQVlDLFFBQVosR0FBdUJDLFFBQXZCLENBQWdDLENBQWhDLEVBQW1DQyxRQUFuQyxDQUE0Q1AsSUFBNUM7QUFDSDtBQUNKLEtBVEQ7QUFVSCxHQS9JVztBQWdKVitDLEVBQUFBLGNBaEpVLDRCQWdKTztBQUFDO0FBQ2hCLFFBQUlwQyxhQUFKLEVBQW1CO0FBQ2ZDLE1BQUFBLE1BQU0sQ0FBQ0MsRUFBUCxDQUFVYyxXQUFWLENBQXNCO0FBQ2xCQyxRQUFBQSxXQUFXLEVBQUU7QUFESyxPQUF0QjtBQUdILEtBSkQsTUFJTztBQUNIckQsTUFBQUEsRUFBRSxDQUFDdUQsR0FBSCxDQUFPLFVBQVA7QUFDSDtBQUNKLEdBeEpXO0FBeUpWa0IsRUFBQUEsV0F6SlUsdUJBeUpFQyxLQXpKRixFQXlKUztBQUFFO0FBQ25CLFFBQUl0QyxhQUFKLEVBQW1CO0FBQ2ZDLE1BQUFBLE1BQU0sQ0FBQ0MsRUFBUCxDQUFVYyxXQUFWLENBQXNCO0FBQ2xCQyxRQUFBQSxXQUFXLEVBQUUsQ0FESztBQUVsQlgsUUFBQUEsYUFBYSxFQUFFbkQsVUFBVSxDQUFDbUQsYUFGUjtBQUdsQmdDLFFBQUFBLEtBQUssRUFBRUE7QUFIVyxPQUF0QjtBQUtILEtBTkQsTUFNTztBQUNIMUUsTUFBQUEsRUFBRSxDQUFDdUQsR0FBSCxDQUFPLFVBQVVoRSxVQUFVLENBQUNtRCxhQUFyQixHQUFxQyxLQUFyQyxHQUE2Q2dDLEtBQXBEO0FBQ0g7QUFDSixHQW5LVztBQXFLVkMsRUFBQUEsZUFyS1UsMkJBcUtNTixHQXJLTixFQXFLVztBQUN2QjtBQUNJLFFBQUlBLEdBQUcsR0FBRyxDQUFWLEVBQWE7QUFDVEEsTUFBQUEsR0FBRyxHQUFHLENBQU47QUFDSCxLQUZELE1BRU8sSUFBSUEsR0FBRyxHQUFHLENBQVYsRUFBYTtBQUNoQkEsTUFBQUEsR0FBRyxHQUFHLENBQU47QUFDSCxLQUZNLE1BRUEsSUFBSUEsR0FBRyxHQUFHLEVBQVYsRUFBYztBQUNqQkEsTUFBQUEsR0FBRyxHQUFHLENBQU47QUFDSCxLQUZNLE1BRUEsSUFBSUEsR0FBRyxHQUFHLEVBQVYsRUFBYztBQUNqQkEsTUFBQUEsR0FBRyxHQUFHLEVBQU47QUFDSCxLQUZNLE1BRUEsSUFBSUEsR0FBRyxHQUFHLEVBQVYsRUFBYztBQUNqQkEsTUFBQUEsR0FBRyxHQUFHLEVBQU47QUFDSCxLQUZNLE1BRUEsSUFBSUEsR0FBRyxHQUFHLEdBQVYsRUFBZTtBQUNsQkEsTUFBQUEsR0FBRyxHQUFHLEVBQU47QUFDSCxLQUZNLE1BRUEsSUFBSUEsR0FBRyxHQUFHLEdBQVYsRUFBZTtBQUNsQkEsTUFBQUEsR0FBRyxHQUFHLEdBQU47QUFDSCxLQUZNLE1BRUEsSUFBSUEsR0FBRyxHQUFHLEdBQVYsRUFBZTtBQUNsQkEsTUFBQUEsR0FBRyxHQUFHLEdBQU47QUFDSCxLQUZNLE1BRUEsSUFBSUEsR0FBRyxHQUFHLElBQVYsRUFBZ0I7QUFDbkJBLE1BQUFBLEdBQUcsR0FBRyxHQUFOO0FBQ0gsS0FGTSxNQUVBLElBQUlBLEdBQUcsR0FBRyxJQUFWLEVBQWdCO0FBQ25CQSxNQUFBQSxHQUFHLEdBQUcsSUFBTjtBQUNILEtBRk0sTUFFQSxJQUFJQSxHQUFHLEdBQUcsSUFBVixFQUFnQjtBQUNuQkEsTUFBQUEsR0FBRyxHQUFHLElBQU47QUFDSCxLQUZNLE1BRUEsSUFBSUEsR0FBRyxHQUFHLElBQVYsRUFBZ0I7QUFDbkJBLE1BQUFBLEdBQUcsR0FBRyxJQUFOO0FBQ0gsS0FGTSxNQUVBLElBQUlBLEdBQUcsR0FBRyxLQUFWLEVBQWlCO0FBQ3BCQSxNQUFBQSxHQUFHLEdBQUcsSUFBTjtBQUNILEtBRk0sTUFFQSxJQUFJQSxHQUFHLEdBQUcsS0FBVixFQUFpQjtBQUNwQkEsTUFBQUEsR0FBRyxHQUFHLEtBQU47QUFDSCxLQUZNLE1BRUEsSUFBSUEsR0FBRyxHQUFHLEtBQVYsRUFBaUI7QUFDcEJBLE1BQUFBLEdBQUcsR0FBRyxLQUFOO0FBQ0gsS0FGTSxNQUVBLElBQUlBLEdBQUcsR0FBRyxNQUFWLEVBQWtCO0FBQ3JCQSxNQUFBQSxHQUFHLEdBQUcsS0FBTjtBQUNILEtBRk0sTUFFQTtBQUNIQSxNQUFBQSxHQUFHLEdBQUcsTUFBTjtBQUNIOztBQUNELFdBQU9BLEdBQVA7QUFDSDtBQTNNVyxDQUFoQjtBQThNQU8sTUFBTSxDQUFDQyxPQUFQLEdBQWlCcEYsU0FBakIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBHYW1lQ29uZmlnID0gcmVxdWlyZShcIkdhbWVDb25maWdcIik7XG52YXIgR2FtZVRvb2xzID0ge1xuICAgIGxvdmUyMDQ4RnJhbWVDYWNoZTogbnVsbCxcbiAgICBudW1iZXJMYWJlbEF0bGFzOiBudWxsLFxuICAgIGJhY2tNdXNpY0lzUGxheTogbnVsbCxcbiAgICBwbGF5U2ltcGxlQXVkaW9FbmdpbmU6IGZ1bmN0aW9uIChlbmdpbmVUeXBlKSB7XG4gICAgICAgIGlmIChHYW1lQ29uZmlnLklTX0dBTUVfTVVTSUMpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoZW5naW5lVHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUucGxheShjYy51cmwucmF3KCdyZXNvdXJjZXMvc291bmRzL3BvcF9zdGFyLm1wMycpLCBmYWxzZSwgMC41KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5wbGF5KGNjLnVybC5yYXcoJ3Jlc291cmNlcy9zb3VuZHMvc2VsZWN0Lm1wMycpLCBmYWxzZSwgMC41KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5wbGF5KGNjLnVybC5yYXcoXCJyZXNvdXJjZXMvc291bmRzL2xhbmRpbmcubXAzXCIpLCBmYWxzZSwgMC41KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBjYy5hdWRpb0VuZ2luZS5wbGF5KGNjLnVybC5yYXcoXCJyZXNvdXJjZXMvc291bmRzL2NoZWVycy5tcDNcIiksIGZhbHNlLCAwLjUpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG4gICAgcGxheUJhY2tncm91bmRNdXNpYzogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoR2FtZUNvbmZpZy5JU19HQU1FX01VU0lDKSB7XG4gICAgICAgICAgICBpZiAoR2FtZVRvb2xzLmJhY2tNdXNpY0lzUGxheSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgR2FtZVRvb2xzLmJhY2tNdXNpY0lzUGxheSA9IGNjLmF1ZGlvRW5naW5lLnBsYXkoY2MudXJsLnJhdygncmVzb3VyY2VzL3NvdW5kcy9iYWNrTXVzaWMubXAzJyksIHRydWUsIDAuNSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHN0b3BCYWNrZ3JvdW5kTXVzaWM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKEdhbWVUb29scy5iYWNrTXVzaWNJc1BsYXkgIT0gbnVsbCkge1xuICAgICAgICAgICAgY2MuYXVkaW9FbmdpbmUuc3RvcChHYW1lVG9vbHMuYmFja011c2ljSXNQbGF5KTtcbiAgICAgICAgICAgIEdhbWVUb29scy5iYWNrTXVzaWNJc1BsYXkgPSBudWxsO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBnZXRJdGVtQnlMb2NhbFN0b3JhZ2U6IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XG4gICAgICAgIGxldCB2YWx1ZXMgPSBjYy5zeXMubG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KTtcbiAgICAgICAgaWYgKHZhbHVlcyA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlcyA9PT0gbnVsbCB8fCB2YWx1ZXMgPT09ICcnKSB7XG4gICAgICAgICAgICBjYy5zeXMubG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCB2YWx1ZSk7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlcyA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBcInRydWVcIiA9PSB2YWx1ZXM7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgcmV0dXJuIE51bWJlcih2YWx1ZXMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZXM7XG4gICAgfSxcbiAgICBzZXRJdGVtQnlMb2NhbFN0b3JhZ2U6IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7XG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIHZhbHVlKTtcbiAgICB9LFxuICAgIHRvYXN0TWVzc2FnZSh0b2FzdFR5cGUpIHtcbiAgICAgICAgY2MubG9hZGVyLmxvYWRSZXMoXCJwYW5lbC9TaG93TWVzc2FnZVwiLCAoZXJyLCBwcmVmYWIpID0+IHtcbiAgICAgICAgICAgIGlmICghZXJyKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5vZGUgPSBjYy5pbnN0YW50aWF0ZShwcmVmYWIpO1xuICAgICAgICAgICAgICAgIG5vZGUuZ2V0Q29tcG9uZW50KGNjLkNvbXBvbmVudCkudG9hc3RUeXBlID0gdG9hc3RUeXBlO1xuICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmdldFNjZW5lKCkuY2hpbGRyZW5bMF0uYWRkQ2hpbGQobm9kZSk7XG4gICAgICAgICAgICAgICAgLy8gY2MuZGlyZWN0b3IuZ2V0U2NlbmUoKS5nZXRDaGlsZEJ5TmFtZSgnQ2FudmFzJykuYWRkQ2hpbGQobm9kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAsIHNoYXJlUGljdHVyZShwaWN0dXJlTmFtZSkge1xuICAgICAgICBsZXQgdGl0bGVTdHIgPSAn5p2l6Lef5oiR5LiA6LW35oyR5oiY5rWq5ryrMjA0OOWQp+OAgic7XG4gICAgICAgIGlmIChcInNoYXJlVGlja2V0XCIgPT0gcGljdHVyZU5hbWUpIHtcbiAgICAgICAgICAgIHRpdGxlU3RyID0gXCLnnIvnnIvkvaDlnKjnvqTph4zmjpLnrKzlh6DvvJ/mnaXlkozmiJHmjJHmiJjmtarmvKsyMDQ45ZCn44CCXCI7XG4gICAgICAgIH0gZWxzZSBpZiAoXCJMb3R0ZXJ5TGF5ZXJcIiA9PSBwaWN0dXJlTmFtZSkgey8v5oq95aWW6aG16Z2i5YiG5LqrXG4gICAgICAgICAgICB0aXRsZVN0ciA9IFwi5rWq5ryrMjA0OOemj+WIqeWkp+aUvumAge+8geW/q+i/m+adpeaKveWlluWQp++8gVwiO1xuICAgICAgICB9IGVsc2UgaWYgKHBpY3R1cmVOYW1lICE9IHVuZGVmaW5lZCAmJiBwaWN0dXJlTmFtZSAhPSBudWxsKSB7XG4gICAgICAgICAgICB0aXRsZVN0ciA9IFwi5oiR5b6X5LqGXCIgKyBwaWN0dXJlTmFtZSArIFwi5YiGLFwiICsgdGl0bGVTdHI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKENDX1dFQ0hBVEdBTUUpIHtcbiAgICAgICAgICAgIHdpbmRvdy53eC5zaGFyZUFwcE1lc3NhZ2Uoe1xuICAgICAgICAgICAgICAgIHRpdGxlOiB0aXRsZVN0cixcbiAgICAgICAgICAgICAgICBxdWVyeTogXCJ4PVwiICsgR2FtZUNvbmZpZy5NQUlOX01FTlVfTlVNLFxuICAgICAgICAgICAgICAgIGltYWdlVXJsOiBjYW52YXMudG9UZW1wRmlsZVBhdGhTeW5jKHtcbiAgICAgICAgICAgICAgICAgICAgZGVzdFdpZHRoOiA1MDAsXG4gICAgICAgICAgICAgICAgICAgIGRlc3RIZWlnaHQ6IDQwMFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IChyZXMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5zaGFyZVRpY2tldHMgIT0gdW5kZWZpbmVkICYmIHJlcy5zaGFyZVRpY2tldHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFwic2hhcmVUaWNrZXRcIiA9PSBwaWN0dXJlTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy53eC5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VUeXBlOiA1LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNQUlOX01FTlVfTlVNOiBHYW1lQ29uZmlnLk1BSU5fTUVOVV9OVU0gPT0gLTEwMDAgPyAxIDogR2FtZUNvbmZpZy5NQUlOX01FTlVfTlVNLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZVRpY2tldDogcmVzLnNoYXJlVGlja2V0c1swXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYy5sb2coXCLmiafooYzkuobmiKrlm75cIiArIHRpdGxlU3RyKTtcbiAgICAgICAgfVxuICAgIH0sXG4gICAgZ2V0R2FtZUludGVncmFsKCkgeyAvL+iOt+WPluenr+WIhlxuICAgICAgICByZXR1cm4gdGhpcy5nZXRJdGVtQnlMb2NhbFN0b3JhZ2UoXCJHYW1lSW50ZWdyYWxcIiwgMCk7XG4gICAgfSxcbiAgICBzZXRHYW1lSW50ZWdyYWwoaW50cmdyYWwpIHsgLy8g6K6+572u56ev5YiGXG4gICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIkdhbWVJbnRlZ3JhbFwiLCBpbnRyZ3JhbCk7XG4gICAgfVxuICAgICwgY29tbWVudEdhbWUoKSB7IC8v6K+E6K66XG4gICAgICAgIGlmIChDQ19XRUNIQVRHQU1FKSB7XG4gICAgICAgICAgICB3aW5kb3cud3gub3BlbkN1c3RvbWVyU2VydmljZUNvbnZlcnNhdGlvbih7fSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRvYXN0TWVzc2FnZSgxKTtcbiAgICAgICAgICAgIGNjLmxvZyhcIuaJp+ihjOS6huivhOiuulwiKVxuICAgICAgICB9XG4gICAgfVxuICAgICwgY2hlY2tGaXJzdExvZ2luR2FtZSgpIHsgLy/mo4Dmn6XmmK/lkKbpppbmrKHnmbvlvZVcbiAgICAgICAgbGV0IGxvZ2luRGF0ZSA9IE1hdGguZmxvb3IoKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC0gbmV3IERhdGUoMjAxOCwgMywgMTgsIDAsIDAsIDAsIDApLmdldFRpbWUoKSkgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpO1xuICAgICAgICBpZiAobG9naW5EYXRlID4gdGhpcy5nZXRJdGVtQnlMb2NhbFN0b3JhZ2UoXCJGaXJzdEVudGVyR2FtZURhdGVcIiwgMCkpIHtcbiAgICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIkZpcnN0RW50ZXJHYW1lRGF0ZVwiLCBsb2dpbkRhdGUpO1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRHYW1lSW50ZWdyYWwodGhpcy5nZXRHYW1lSW50ZWdyYWwoKSArIDEwMCk7XG4gICAgICAgICAgICAgICAgdGhpcy50b2FzdE1lc3NhZ2UoOSk7XG4gICAgICAgICAgICB9LCAxNTAwKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgICwgc2V0Q2FyZEJhY2tQYXRoKG51bSkvL+iuvue9ruWNoeeJh+iDjOaZr+i3r+W+hFxuICAgIHtcbiAgICAgICAgLy9HYW1lQ29uZmlnLnNldENhcmRCYWNrUGF0aChudW0sIFwiY2FyZC9ubDIwNDgucG5nXCIpO1xuICAgIH1cblxuICAgICwgdXNlckxvZ2luKCkgeyAvL+eUqOaIt+eZu+W9lVxuICAgIH1cblxuICAgICwgZ2V0UmFua0RhdGEoc2hhcmVUaWNrZXQpIHsgLy/ojrflj5bmjpLooYzmppxcbiAgICAgICAgY2MubG9hZGVyLmxvYWRSZXMoXCJwYW5lbC9SYW5raW5nTGlzdFZpZXdcIiwgKGVyciwgcHJlZmFiKSA9PiB7XG4gICAgICAgICAgICBpZiAoIWVycikge1xuICAgICAgICAgICAgICAgIHZhciBub2RlID0gY2MuaW5zdGFudGlhdGUocHJlZmFiKTtcbiAgICAgICAgICAgICAgICBpZiAoc2hhcmVUaWNrZXQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGUuZ2V0Q29tcG9uZW50KGNjLkNvbXBvbmVudCkuc2hhcmVUaWNrZXQgPSBzaGFyZVRpY2tldDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gbm9kZS5zZXRQb3NpdGlvbihjYy5wKDAsIDApKTtcbiAgICAgICAgICAgICAgICBjYy5kaXJlY3Rvci5nZXRTY2VuZSgpLmNoaWxkcmVuWzBdLmFkZENoaWxkKG5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLCByZW1vdmVSYW5rRGF0YSgpIHsvL+enu+mZpOaOkuihjOamnOaVsOaNrlxuICAgICAgICBpZiAoQ0NfV0VDSEFUR0FNRSkge1xuICAgICAgICAgICAgd2luZG93Lnd4LnBvc3RNZXNzYWdlKHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlVHlwZTogMCxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2MubG9nKFwi56e76Zmk5o6S6KGM5qac5pWw5o2u44CCXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgICwgc3VibWl0U2NvcmUoc2NvcmUpIHsgLy/mj5DkuqTlvpfliIZcbiAgICAgICAgaWYgKENDX1dFQ0hBVEdBTUUpIHtcbiAgICAgICAgICAgIHdpbmRvdy53eC5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgICAgICAgbWVzc2FnZVR5cGU6IDMsXG4gICAgICAgICAgICAgICAgTUFJTl9NRU5VX05VTTogR2FtZUNvbmZpZy5NQUlOX01FTlVfTlVNLFxuICAgICAgICAgICAgICAgIHNjb3JlOiBzY29yZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2MubG9nKFwi5o+Q5Lqk5b6X5YiGOlwiICsgR2FtZUNvbmZpZy5NQUlOX01FTlVfTlVNICsgXCIgOiBcIiArIHNjb3JlKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLCBnZXRTZWxlY3RBZGROdW0obnVtKSAvL+iOt+WPluWPoOWKoOaVsFxuICAgIHtcbiAgICAgICAgaWYgKG51bSA8IDQpIHtcbiAgICAgICAgICAgIG51bSA9IDI7XG4gICAgICAgIH0gZWxzZSBpZiAobnVtIDwgOCkge1xuICAgICAgICAgICAgbnVtID0gNDtcbiAgICAgICAgfSBlbHNlIGlmIChudW0gPCAxNikge1xuICAgICAgICAgICAgbnVtID0gODtcbiAgICAgICAgfSBlbHNlIGlmIChudW0gPCAzMikge1xuICAgICAgICAgICAgbnVtID0gMTY7XG4gICAgICAgIH0gZWxzZSBpZiAobnVtIDwgNjQpIHtcbiAgICAgICAgICAgIG51bSA9IDMyO1xuICAgICAgICB9IGVsc2UgaWYgKG51bSA8IDEyOCkge1xuICAgICAgICAgICAgbnVtID0gNjQ7XG4gICAgICAgIH0gZWxzZSBpZiAobnVtIDwgMjU2KSB7XG4gICAgICAgICAgICBudW0gPSAxMjg7XG4gICAgICAgIH0gZWxzZSBpZiAobnVtIDwgNTEyKSB7XG4gICAgICAgICAgICBudW0gPSAyNTY7XG4gICAgICAgIH0gZWxzZSBpZiAobnVtIDwgMTAyNCkge1xuICAgICAgICAgICAgbnVtID0gNTEyO1xuICAgICAgICB9IGVsc2UgaWYgKG51bSA8IDIwNDgpIHtcbiAgICAgICAgICAgIG51bSA9IDEwMjQ7XG4gICAgICAgIH0gZWxzZSBpZiAobnVtIDwgNDA5Nikge1xuICAgICAgICAgICAgbnVtID0gMjA0ODtcbiAgICAgICAgfSBlbHNlIGlmIChudW0gPCA4MTkyKSB7XG4gICAgICAgICAgICBudW0gPSA0MDk2O1xuICAgICAgICB9IGVsc2UgaWYgKG51bSA8IDE2Mzg0KSB7XG4gICAgICAgICAgICBudW0gPSA4MTkyO1xuICAgICAgICB9IGVsc2UgaWYgKG51bSA8IDMyNzY4KSB7XG4gICAgICAgICAgICBudW0gPSAxNjM4NDtcbiAgICAgICAgfSBlbHNlIGlmIChudW0gPCA2NTUzNikge1xuICAgICAgICAgICAgbnVtID0gMzI3Njg7XG4gICAgICAgIH0gZWxzZSBpZiAobnVtIDwgMTMxMDcyKSB7XG4gICAgICAgICAgICBudW0gPSA2NTUzNjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG51bSA9IDEzMTA3MjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVtO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gR2FtZVRvb2xzOyJdfQ==